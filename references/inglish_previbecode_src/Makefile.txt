# Makefile for Inglish Translator

.PHONY: help install test benchmark clean example

# Default target
help:
	@echo "Inglish Translator - Available Commands:"
	@echo ""
	@echo "  make install       - Install dependencies"
	@echo "  make test          - Run unit tests"
	@echo "  make example       - Run usage examples"
	@echo "  make benchmark     - Run baseline benchmark"
	@echo "  make clean         - Clean generated files"
	@echo "  make format        - Format code with black"
	@echo "  make lint          - Run code linting"
	@echo ""

# Install dependencies
install:
	@echo "Installing dependencies..."
	pip install -r requirements.txt
	@echo "Installation complete!"

# Install in development mode
install-dev:
	@echo "Installing in development mode..."
	pip install -e .
	pip install -r requirements.txt
	@echo "Development installation complete!"

# Run tests
test:
	@echo "Running tests..."
	pytest tests/ -v --cov=src --cov-report=html
	@echo "Tests complete! Coverage report in htmlcov/index.html"

# Run quick test
test-quick:
	@echo "Running quick tests..."
	pytest tests/ -v
	@echo "Tests complete!"

# Run usage examples
example:
	@echo "Running usage examples..."
	python examples/basic_usage.py
	@echo "Examples complete!"

# Run baseline benchmark
benchmark:
	@echo "Running baseline benchmark..."
	python benchmarks/baseline_benchmark.py \
		--dataset data/datasets/eval/programming_eval.json \
		--domain programming \
		--output results/baseline_results.json \
		--verbose
	@echo "Benchmark complete! Results in results/baseline_results.json"

# Run benchmark without verbose output
benchmark-quiet:
	@echo "Running baseline benchmark (quiet mode)..."
	python benchmarks/baseline_benchmark.py \
		--dataset data/datasets/eval/programming_eval.json \
		--domain programming \
		--output results/baseline_results.json
	@echo "Benchmark complete!"

# Format code
format:
	@echo "Formatting code with black..."
	black src/ tests/ benchmarks/ examples/
	@echo "Formatting complete!"

# Lint code
lint:
	@echo "Running flake8..."
	flake8 src/ tests/ benchmarks/ examples/ --max-line-length=100
	@echo "Linting complete!"

# Type checking
typecheck:
	@echo "Running mypy..."
	mypy src/ --ignore-missing-imports
	@echo "Type checking complete!"

# Clean generated files
clean:
	@echo "Cleaning generated files..."
	rm -rf __pycache__
	rm -rf src/__pycache__
	rm -rf tests/__pycache__
	rm -rf benchmarks/__pycache__
	rm -rf .pytest_cache
	rm -rf .mypy_cache
	rm -rf htmlcov
	rm -rf .coverage
	rm -rf results/*.json
	rm -rf *.egg-info
	rm -rf build/
	rm -rf dist/
	@echo "Clean complete!"

# Create necessary directories
setup-dirs:
	@echo "Creating necessary directories..."
	mkdir -p data/glossaries
	mkdir -p data/patterns
	mkdir -p data/datasets/train
	mkdir -p data/datasets/eval
	mkdir -p data/datasets/test
	mkdir -p models
	mkdir -p results
	mkdir -p logs
	@echo "Directories created!"

# Full setup
setup: setup-dirs install
	@echo "Full setup complete!"

# Run all checks before commit
precommit: format lint test
	@echo "Pre-commit checks complete!"